if BR2_PACKAGE_INITRAMFS_BETTER_INITRAMFS

comment "better-initramfs needs mdev or devtmpfs /dev management and no init system"
	depends on !BR2_INIT_NONE || ! ( \
		BR2_ROOTFS_DEVICE_CREATION_DYNAMIC_MDEV || \
		BR2_ROOTFS_DEVICE_CREATION_DYNAMIC_DEVTMPFS )

menuconfig BR2_PACKAGE_BETTER_INITRAMFS
	bool "better-initramfs"

	depends on BR2_PACKAGE_BUSYBOX
	depends on ( \
		BR2_ROOTFS_DEVICE_CREATION_DYNAMIC_MDEV || \
		BR2_ROOTFS_DEVICE_CREATION_DYNAMIC_DEVTMPFS )
	depends on BR2_INIT_NONE
	select BR2_PACKAGE_HAS_INITRAMFS

	help
		An initramfs solution with few dependencies, written in shell script
		language.

		Supports booting from disk (by dev/label/uuid), BCACHE, LVM, LUKS,
		software RAID and more.

		https://github.com/slashbeast/better-initramfs/blob/master/README.rst

		In order to get full functionality, one or more of the following
		packages should be selected:

		  o dropbear   (remote shell)
		  o lvm2       (LVM)
		  o cryptsetup (LUKS)
		  o askpass    (LUKS, remote shell) [not packaged]
		  o mdadm      (software-RAID)
		  o suspend    (resume from hibernate) [?]


if BR2_PACKAGE_BETTER_INITRAMFS

config BR2_PACKAGE_PROVIDES_INITRAMFS
	default "better-initramfs"

config BR2_PACKAGE_BETTER_INITRAMFS_KEYMAP_FILE
	string  "keymap file"
	default ""

	help
		better-initramfs supports loading of a keymap file,
		which helps to get your passphrases accepted ;)

config BR2_PACKAGE_BETTER_INITRAMFS_HOOK_DIRS
	string  "hook dirs"
	default ""

	help
		Allows to import initramfs hooks.

		Each dir should contain one or more of the following directories ("hook phases"):
		  o init
		  o early
		  o pre_newroot_mount
		  o post_newroot_mount [unofficial]
		  o pre_switch_root

endif # BR2_PACKAGE_BETTER_INITRAMFS
endif # BR2_PACKAGE_INITRAMFS_BETTER_INITRAMFS
